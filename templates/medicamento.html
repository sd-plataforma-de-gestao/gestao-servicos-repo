<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medicamentos</title>
  <link rel="icon" href="/assets/favicon.png" type="image/png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/styles/global.css">
  <link rel="stylesheet" href="/styles/sidebar.css">
  <link rel="stylesheet" href="/styles/medicamento.css">
  <link rel="stylesheet" href="/styles/header.css">

</head>
<body>

  <div id="header-container"></div>
  <div id="main-content-wrapper">
  <div id="sidebar-container"></div>
  <!-- =============== CONTEÚDO DA PÁGINA =============== -->
    <div id="main-container">
        <div class="page-header">
        <h2 class="page-title">Medicamentos</h2>
        <p class="page-subtitle">Gestão completa de medicamentos e farmácia.</p>
      </div>
      <div class="medicamentos-page">
        <!-- Barra de busca + filtro -->
        <div class="controls-bar card mb-4">
          <div class="row g-3 align-items-end">
            <div class="col-12 col-md-6">
              <label class="form-label"><i class="fa fa-search"></i> Buscar medicamento</label>
              <input
                type="text"
                class="form-control"
                id="buscaMedicamento"
                placeholder="Nome, princípio ativo ou fabricante..."
              >
            </div>
            <div class="col-12 col-md-4">
              <label class="form-label"><i class="fa fa-filter"></i> Filtro</label>
              <select class="form-select" id="filtroStatus">
                <option value="">Todos os medicamentos</option>
                <option value="disponivel">Disponível</option>
                <option value="baixo">Estoque Baixo</option>
                <option value="esgotado">Esgotado</option>
              </select>
            </div>
            <div class="col-12 col-md-2">
              <button
                class="btn btn-success w-100"
                data-bs-toggle="modal"
                data-bs-target="#medicamentoModal"
              >
                <i class="fa fa-pills"></i> Novo Medicamento
              </button>
            </div>
          </div>
        </div>
        <div class="medicamentos-list card">
          <h2 class="list-title">Lista de Medicamentos</h2>
          <div id="lista-medicamentos"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- =============== MODAL CADASTRAR E EDITAR MEDICAMENTOS =============== -->
  <div class="modal fade" id="medicamentoModal" tabindex="-1" aria-labelledby="medicamentoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <form id="formMedicamento">
          <div class="modal-header">
            <h5 class="modal-title" id="medicamentoModalLabel">Cadastrar Novo Medicamento</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="medicamentoId">

            <div class="row g-3">
              <div class="col-12">
                <label class="form-label">Nome do Medicamento *</label>
                <input type="text" class="form-control" id="nomeMedicamento" required>
              </div>
              <div class="col-6">
                <label class="form-label">Princípio Ativo *</label>
                <input type="text" class="form-control" id="principioAtivo" required>
              </div>
              <div class="col-6">
                <label class="form-label">Dosagem *</label>
                <input type="text" class="form-control" id="dosagem" placeholder="Ex: 500mg" required>
              </div>
              <div class="col-6">
                <label class="form-label">Fabricante *</label>
                <input type="text" class="form-control" id="fabricante" required>
              </div>
              <div class="col-6">
                <label class="form-label">Tipo *</label>
                <select class="form-select" id="tipoMedicamento" required>
                  <option value="">Selecione...</option>
                  <option value="Comprimido">Comprimido</option>
                  <option value="Cápsula">Cápsula</option>
                  <option value="Xarope">Xarope</option>
                  <option value="Injeção">Injeção</option>
                  <option value="Pomada">Pomada</option>
                  <option value="Gotas">Gotas</option>
                </select>
              </div>
              <div class="col-6">
                <label class="form-label">Número do Lote *</label>
                <input type="text" class="form-control" id="numeroLote" required>
              </div>
              <div class="col-6">
                <label class="form-label">Data de Validade *</label>
                <input type="date" class="form-control" id="dataValidade" required>
              </div>
              <div class="col-6">
                <label class="form-label">Quantidade em Estoque *</label>
                <input type="number" class="form-control" id="quantidadeEstoque" min="0" required>
              </div>
              <div class="col-6">
                <label class="form-label">Preço Unitário</label>
                <input type="number" class="form-control" id="precoUnitario" step="0.01" min="0" placeholder="R$ 0,00">
              </div>
              <div class="col-12">
                <label class="form-label">Descrição/Observações</label>
                <textarea class="form-control" id="descricaoMedicamento" rows="3" placeholder="Informações adicionais sobre o medicamento"></textarea>
              </div>
              <div class="col-6">
                <label class="form-label">Requer Receita</label>
                <select class="form-select" id="requerReceita">
                  <option value="Não">Não</option>
                  <option value="Sim">Sim</option>
                  <option value="Controlado">Controlado</option>
                </select>
              </div>
              <div class="col-6">
                <label class="form-label">Condição de Armazenamento</label>
                <select class="form-select" id="condicaoArmazenamento">
                  <option value="">Selecione...</option>
                  <option value="Temperatura Ambiente">Temperatura Ambiente</option>
                  <option value="Refrigerado">Refrigerado (2-8°C)</option>
                  <option value="Congelado">Congelado</option>
                  <option value="Local Seco">Local Seco</option>
                </select>
              </div>
            </div>
            <small class="text-muted mt-2">* Campos obrigatórios</small>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary-custom">Salvar Medicamento</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- =============== MODAL DE VISUALIZAR OS DADOS DOS MEDICAMENTOS CADASTRADOS =============== -->
  <div class="modal fade" id="detalhesMedicamentoModal" tabindex="-1" aria-labelledby="detalhesMedicamentoLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detalhesMedicamentoLabel">Detalhes do Medicamento</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="detalhesCorpo">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="button" class="btn btn-primary-custom" id="btnEditarDoDetalhe">
            <i class="fa fa-edit"></i> Editar
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/medicamento.js"></script>
  <script src="/js/sidebar.js"></script>
  <script src="/js/script.js"></script>
  <script>
    async function loadTemplate(templatePath, containerId) {
      try {
        const response = await fetch(templatePath);
        if (!response.ok) throw new Error(`Erro ${response.status}`);
        const html = await response.text();
        document.getElementById(containerId).innerHTML = html;
      } catch (error) {
        console.error(`Erro ao carregar ${templatePath}:`, error);
      }
    }

    document.addEventListener("DOMContentLoaded", async function () {
      // Carrega header e sidebar
      await loadTemplate("/templates/header.html", "header-container");
      await loadTemplate("/templates/sidebar.html", "sidebar-container");

      // Inicializa as funções do script.js (se existirem e forem globais)
      if (typeof initializeSidebar === 'function') initializeSidebar();
      if (typeof initializeActionButtons === 'function') initializeActionButtons();
      if (typeof initializeTooltips === 'function') initializeTooltips();
      if (typeof initializeNavigation === 'function') initializeNavigation();
      if (typeof setActiveSidebarLink === 'function') setActiveSidebarLink();
    });
  </script>
</body>
</html>

