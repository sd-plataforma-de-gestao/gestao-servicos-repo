<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestão de Unidades</title>

  <!-- Favicons -->
  <link rel="icon" href="/assets/favicon.png" type="image/png">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <link rel="stylesheet" href="/styles/global.css">
  <link rel="stylesheet" href="/styles/header.css">
  <link rel="stylesheet" href="/styles/sidebar.css">
  <link rel="stylesheet" href="/styles/responsive.css">
  <link rel="stylesheet" href="/styles/unidade.css">

</head>
<body>
  <div id="header-container"></div>
  <div id="main-content-wrapper">
    <div id="sidebar-container"></div>
    <div id="main-container">
      <div class="page-header-with-button">
        <div>
          <h2 class="page-title">Gestão de Unidades</h2>
          <p class="page-subtitle">Administração das unidades da rede farmacêutica</p>
        </div>
        <button 
          class="btn btn-success btn-nova-unidade"
          data-bs-toggle="modal"
          data-bs-target="#unidadeModal"
        >
          <i class="fa fa-plus"></i> Nova Unidade
        </button>
      </div>

      <div class="unidades-page">
        <div class="stats-section">
          <div class="row g-3">
            <div class="col-12 col-md-4">
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fa fa-building"></i>
                </div>
                <div class="stat-content">
                  <h3 class="stat-number" id="totalUnidades">3</h3>
                  <p class="stat-label">Total de Unidades</p>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4">
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fa fa-user-md"></i>
                </div>
                <div class="stat-content">
                  <h3 class="stat-number" id="totalFarmaceuticos">7</h3>
                  <p class="stat-label">Farmacêuticos</p>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4">
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fa fa-calendar-check"></i>
                </div>
                <div class="stat-content">
                  <h3 class="stat-number" id="atendimentosHoje">65</h3>
                  <p class="stat-label">Atendimentos Hoje</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="unidades-grid" id="unidadesGrid">
        </div>
      </div>
    </div>
  </div>

  <!-- =============== MODAL CADASTRAR/EDITAR UNIDADE =============== -->
  <div class="modal fade" id="unidadeModal" tabindex="-1" aria-labelledby="unidadeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <form id="formUnidade">
          <div class="modal-header">
            <h5 class="modal-title" id="unidadeModalLabel">Cadastrar Nova Unidade</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="unidadeId">

            <div class="row g-3">
              <div class="col-12">
                <label class="form-label">Nome da Unidade *</label>
                <input type="text" class="form-control" id="nomeUnidade" required>
              </div>
              <div class="col-6">
                <label class="form-label">CNPJ *</label>
                <input type="text" class="form-control" id="cnpjUnidade" placeholder="00.000.000/0000-00" required>
              </div>
              <div class="col-6">
                <label class="form-label">Telefone *</label>
                <input type="text" class="form-control" id="telefoneUnidade" placeholder="(11) 0000-0000" required>
              </div>
              <div class="col-12">
                <label class="form-label">Endereço Completo *</label>
                <input type="text" class="form-control" id="enderecoUnidade" placeholder="Rua, número, bairro, cidade - UF" required>
              </div>
              <div class="col-6">
                <label class="form-label">Farmacêutico Responsável</label>
                <input type="text" class="form-control" id="farmaceuticoResponsavel" placeholder="Nome do farmacêutico">
              </div>
              <div class="col-6">
                <label class="form-label">CRF do Responsável</label>
                <input type="text" class="form-control" id="crfResponsavel" placeholder="CRF-SP 12345">
              </div>
              <div class="col-6">
                <label class="form-label">Horário de Funcionamento</label>
                <input type="text" class="form-control" id="horarioFuncionamento" placeholder="08:00 - 18:00">
              </div>
              <div class="col-6">
                <label class="form-label">Status da Unidade</label>
                <select class="form-select" id="statusUnidade">
                  <option value="Ativa">Ativa</option>
                  <option value="Inativa">Inativa</option>
                  <option value="Manutenção">Em Manutenção</option>
                </select>
              </div>
              <div class="col-12">
                <label class="form-label">Observações</label>
                <textarea class="form-control" id="observacoesUnidade" rows="3" placeholder="Informações adicionais sobre a unidade"></textarea>
              </div>
            </div>
            <small class="text-muted mt-2">* Campos obrigatórios</small>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary-custom">Salvar Unidade</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- =============== MODAL DE DETALHES DA UNIDADE =============== -->
  <div class="modal fade" id="detalhesUnidadeModal" tabindex="-1" aria-labelledby="detalhesUnidadeLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detalhesUnidadeLabel">Detalhes da Unidade</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="detalhesCorpoUnidade">
          <!-- Dados serão preenchidos aqui -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="button" class="btn btn-primary-custom" id="btnEditarUnidade">
            <i class="fa fa-edit"></i> Editar
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/unidade.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/sidebar.js"></script>
  <script>
    async function loadTemplate(templatePath, containerId) {
      try {
        const response = await fetch(templatePath);
        if (!response.ok) throw new Error(`Erro ${response.status}`);
        const html = await response.text();
        document.getElementById(containerId).innerHTML = html;
      } catch (error) {
        console.error(`Erro ao carregar ${templatePath}:`, error);
      }
    }

    document.addEventListener("DOMContentLoaded", async function () {

      await loadTemplate("/templates/header.html", "header-container");
      await loadTemplate("/templates/sidebar.html", "sidebar-container");

      if (typeof initializeSidebar === 'function') initializeSidebar();
      if (typeof initializeActionButtons === 'function') initializeActionButtons();
      if (typeof initializeTooltips === 'function') initializeTooltips();
      if (typeof initializeNavigation === 'function') initializeNavigation();
      if (typeof setActiveSidebarLink === 'function') setActiveSidebarLink();
    });
  </script>
</body>
</html>

